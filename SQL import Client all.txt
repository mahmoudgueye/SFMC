SELECT 
PersonContactId AS 'Id',
'Saint-Laurent' AS 'Brand',
RecordTypeId AS 'RecordTypeId',
Salutation AS 'MrOrMrs',
Gender__c AS 'Gender',
Title__c AS 'Title',
FirstName AS 'LocalFirstName',
LastName AS 'LocalLastName',
MiddleName as 'LocalMiddleName',
KeringId__c AS 'KeringId',
PersonEmail AS 'Email',
MethodOfContact__c AS 'PreferredMethodOfContact',
TimeOfContact__c AS 'PreferredTimeOfContact',
LineAddress1__c AS 'AddressLine1',
LineAddress2__c AS 'AddressLine2',
City__c AS 'City',
ZipCode__c AS 'Zipcode',
Country__c  AS 'Country',
MarketingActivitiesOptedIn__c AS 'ConsentForMarketingActivities', 
ProfilingOptedIn__c AS 'ConsentForProfiling',
PersonHasOptedInOfEmail__c  AS 'ContactViaEmail',
PostalMailOptedIn__c AS 'ContactViaMail',
PhoneOptedIn__c AS 'ContactViaPhone',
SMSOptedIn__c AS 'ContactViaSmsMms',
UnsubscriptionDate__c AS 'UnsubscriptionDate',
State__c AS 'StatePrefecture',
Type AS 'CustomerType',
LightSegmentation__c AS 'LightSegmentation',
Segmentation__c AS 'Segmentation',
TotalSales__c AS 'TotalSales',
TotalSalesLast12Months__c   AS 'TotalSalesLast12Months',
PreferredStore__c AS 'PreferredStoreId',
PreferredSA__c AS 'PreferredSaKeringId',
PreferredSAFirstName__c AS 'PreferredSaFirstName',
PreferredSALastName__c AS 'PreferredSaLastName',
PreferredLanguage__c AS ' PreferredLanguage',
ProfessionType__c AS 'ProfessionType',
BirthdateDDMM__c AS 'BirthDateDdMm',
YearOfBirthYYYY__c AS 'BirthdateYear',
CertifiedYearOfBirth__c AS 'CertifiedYearOfBirthYyyy',
CertifiedBirthdate__c AS 'CertifiedDayMonthOfBirthDdMm',
AgeRange__c AS 'AgeRange',
LunarCalenderBirthdate__c AS 'LunarCalendarBirthdate',
GlobalLastName__c AS 'GlobalLastName',
GlobalFirstName__c AS 'GlobalFirstName',
GlobalMiddleName__c AS 'GlobalMiddleName',
EnglishName__c AS 'EnglishName',
FuriganaLastName__c AS 'FuriganaLastName',
FuriganaFirstName__c AS 'FuriganaFirstName',
Company__c AS 'Company',
Nationality__c AS 'Nationality',
MobilePhoneCountryCode__c AS 'MobilePhoneCountryCode',
MobilePhone__c AS 'MobilePhone',
HomePhonePrefix__c  AS 'HomePhonePrefix',
HomePhone__c AS 'HomePhone',
WorkPhonePrefix__c AS 'WorkPhonePrefix',
WorkPhone__c AS 'WorkPhone',
RegistrationStore__c AS 'RegistrationStoreId',
PreferredLanguage__c AS 'PreferredLanguage',
PS.StoreCode AS 'PreferredStoreKeringId',
Users.Email AS 'PreferredSaEmail',
CreatedDate AS 'CreatedDate',
CASE WHEN Mobile_Phone_Validity__c = 'Y' THEN 'True' ELSE 'False' END AS 'MobilePhoneValidityFlag',
CASE WHEN Mail_Address_Validity__c = 'Y' THEN 'True' ELSE 'False' END AS 'PostalMailValidityFlag',
CASE WHEN DQMValidity__c = 'Y' THEN 'True' ELSE 'False' END AS 'EmailValidityFlag',
MobilePhonePrefix__c as 'MobilePhonePrefix', 
SAOfRegistration__c as 'SAOfRegistration',

CASE WHEN CR.Region = null THEN 'Unknown'    
    ELSE CR.Region END
AS 'Region',
PurchasingBehaviour__c	as 'PurchasingBehaviour',
POBox__c as 'POBox',
SpecialTreatmentCustomer__c as 'CustomerSpecialTreatment',
CommentForSpecialTreatment__c as 'SpecialTreatmentComment',
AccountSource as 'AccountSource'

FROM ENT.Account_Salesforce A_SF
LEFT JOIN (SELECT Country, Region FROM ENT.CountryRegion WHERE Brand = 'Yves Saint Laurent') CR ON (UPPER(CR.Country) = UPPER(A_SF.Country__c))
LEFT JOIN PreferredStores PS ON PS.Id = A_SF.PreferredStore__c
LEFT JOIN Users ON A_SF.PreferredSA__c = Users.KeringId
WHERE
RecordTypeId = '0120Y000000yHZaQAM'
and KeringId__c != ''
AND LastModifiedDate > getdate()-2